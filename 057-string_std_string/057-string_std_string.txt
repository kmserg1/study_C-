Урок No 57.Строки (std::string)
		  
Вашей первой программой на языке C++, вероятно, была всем известная программа «Hello,world!»:

1 #include <iostream>
2
3 int main()
4 {
5 std::cout << "Hello, world!" << std::endl;
6 return 0;
7 }

Не так ли? Но что такое Hello, world!? Hello, world! — это последовательность символов или просто строка (англ.
«string»). Вязыке C++ мы используем строки для представления текста (имен, адресов, слов и предложений). Строковые
литералы (такие как Hello, world!) помещаются в двойные кавычки.
Поскольку их часто используют в программах, то большинство современных языков программирования имеют встроенный
тип данных string. В языке C++ есть также этот тип, но не как часть основного языка, а как часть Стандартной библиотеки С++.

Оглавление:
1. Тип данных string
2. Ввод/вывод строк
3. Использование std::getline()
4. Использование std::getline() с std::cin
5. Добавление  строк
6. Длина строк
7. Тест

Чтобы иметь возможность использовать строки в C++, сначала нужно подключить заголовочный файл string. Как только это
будет сделано, мы сможем определять переменные типа string:

1 #include <string>
2
3 //...
4 std::string name;
5 //...

Как и с обычными переменными, мы можем инициализировать переменные типа string или присваивать им значения:
1 std::string name("Sasha"); //  инициализируем переменную name строковым литералом "Sasha"
2 name ="Masha"; // присваиваем переменной name строковый литерал "Masha"

Строки такжемогут содержать числа:
1 std::string myID("34"); // "34" здесь - это не целое число 34!

Стоит отметить, что присваиваемые числа тип string обрабатывает как текст, а не как числа, и, следовательно, ими нельзя
манипулировать как обычными числами (например, вы не сможете выполнять с ними арифметические операции). Язык C++
автоматически не преобразовывает их в значения целочисленных типов или типов с плавающей точкой. 


Ввод/вывод строк

Строки можно выводить с помощью std::cout:
1 #include<iostream>
2 #include<string>  
3
4 int main()
5 {
6 std::string name("Sasha");      
7 std::cout<<"My name is"<< name;  
8
9 return 0;
10 }

Результат выполнения программы:
My name is Sasha

А вот с std::cin дела обстоят несколько иначе. Рассмотрим следующий пример:

1 #include <iostream>
2
3 #include <string>
4 main()
5 int{
6 std::cout << "Enter your full name: ";
7 std::string myName;
8 std::cin >> myName; // это будет работать не так, как ожидается, поскольку извлечение данных из потока std::cin останавливается на первом пробеле
9
10 std::cout << "Enter your age:";
11 std::string myAge;
12 std::cin >> myAge;
13 
14 std::cout << "Your name is" << myName << " and your age is " << myAge;
15 }

Результат выполнения программы:
Enter your full name: Sasha Mak
Enter your age: Your name is Sasha and your age is Mak

Хм, что-то не так! Что же случилось? Оказывается, оператор извлечения (>>) возвращает символы из входного потока данных
только до первого пробела. Все остальные символы остаются внутри cin, ожидая следующего извлечения.
Поэтому, когда мы использовали оператор >> для извлечения данных в переменную myName, только Sasha был извлечен,
Mak остался внутри std::cin, ожидая следующего извлечения.
Когда мы использовали оператор  >> снова, чтобы извлечь данные в переменную myAge, мы получили Mak вместо  25.
Если бы мы сделали третье извлечение, то получили бы 25.


Использование std::getline()

Чтобы извлечь полную строку из входного потока данных (вместе с пробелами), используйте функцию std::getline(). Она
принимает два параметра: первый — std::cin, второй — переменная типа string.
Вот программа, приведенная выше, но уже с использованием std::getline():

1 #include<iostream>
2 #include<string>  
3
4 int main()
5 {
6 std::cout << "Enter your fullname: ";
7 std::string myName;
8 std::getline(std::cin,myName); // полностью извлекаем строку в переменную myName
9
10 std::cout << "Enter your  age:";
11 std::string myAge;
12 std::getline(std::cin,myAge); // полностью извлекаем строку в переменную myAge
13
14 std::cout<<"Yournameis" << myName <<"andyourage is"<< myAge;
15 }

Теперь работает как надо:
Enter your full name: Sasha Mak
Enter your age: 25
Your name is Sasha Mak and your age is 25


Использование std::getline() c std::cin

Извлечение данных из std::cin с помощью std::getline() иногда может приводить к неожиданным 
результатам. Например, рассмотрим следующую программу:

1 #include <iostream>
2 #include <string>
3 
4 int main()
5 {
6    std::cout << "Pick 1 or 2: ";
7    int choice;
8    std::cin >> choice;
9 
10    std::cout << "Now enter your name: ";
11    std::string myName;
12    std::getline(std::cin, myName);
13
14    std::cout << "Hello, " << myName << ", you picked " << choice << '\n';
15 
16    return 0;
17 }

Возможно, вы удивитесь, но когда вы запустите эту программу, и она попросит вас ввести ваше имя, 
она не будет ожидать вашего ввода, а сразу выведет результат (просто пробел вместо вашего имени)!

Пробный запуск программы:

Pick 1 or 2: 2
Now enter your name: Hello, , you picked 2

Почему так? Оказывается, когда вы вводите числовое значение, поток cin захватывает вместе с вашим 
числом и символ новой строки. Поэтому, когда мы ввели 2, cin фактически получил 2\n. 
Затем он извлек значение 2 в переменную, оставляя \n (символ новой строки) во входном потоке. 
Затем, когда std::getline() извлекает данные для myName, он видит в потоке \n и думает, что мы, 
должно быть, ввели просто пустую строку! А это определенно не то, что мы хотим.

Хорошей практикой является удалять из входного потока данных символ новой строки. 
Это можно сделать следующим образом:
std::cin.ignore(32767, '\n');  // игнорируем символы перевода строки "\n" во входящем потоке длиной 32767 символов

Если мы вставим эту строку непосредственно после получения входных данных, то символ новой строки будет удален из входного потока, 
и программа будет работать должным образом:

1 #include <iostream>
2 #include <string>
3  
4 int main()
5 {
6 	std::cout << "Pick 1 or 2: ";
7 	int choice;
8 	std::cin >> choice;
9  
10	std::cin.ignore(32767, '\n'); // удаляем символ новой строки из входного потока данных
11 
12	std::cout << "Now enter your name: ";
13	std::string myName;
14	std::getline(std::cin, myName);
15 
16	std::cout << "Hello, " << myName << ", you picked " << choice << '\n';
17 
18	return 0;
19 }

Правило: При вводе числовых значений не забывайте удалять символ новой строки из входного потока 
данных с помощью std::cin.ignore().


Добавление строк

Вы можете использовать оператор + для объединения двух строк или оператор += для добавления одной строки к другой.

В следующей программе мы протестируем эти два оператора, а также покажем, что произойдет, если вы попытаетесь использовать 
оператор + для соединения двух числовых строк:

1 #include <iostream>
2 #include <string>
3  
4 int main()
5 {
6     std::string x("44");
7     std::string y("12");
8  
9     std::cout << x + y << "\n"; // объединяем строки x и y (а не складываем числа)
10    x += " cats";
11    std::cout << x;
12 
13    return 0;
14}

Результат выполнения программы:

4412
44 cats

Обратите внимание, оператор + объединил две числовые строки в одну (44 + 12 = 4412). Он не складывал эти строки как числа.


Длина строк

Чтобы узнать длину строки, мы можем сделать следующее:

1 #include <iostream>
2 #include <string>
3  
4 int main()
5  
6 {
7     std::string myName("Sasha");
8     std::cout << myName << " has " << myName.length() << " characters\n";
9     return 0;
10 }

Результат выполнения программы:
Sasha has 5 characters

Обратите внимание, вместо запроса длины строки как length(myName), мы пишем myName.length().
Функция запроса длины строки не является обычной функцией как те, которые мы использовали ранее. Это особый тип функции 
класса std::string, который называется методом. Мы поговорим об этом детально, когда будем рассматривать классы.


Тест

Напишите программу, которая просит у пользователя ввести его имя, фамилию и возраст. 
В результате, укажите пользователю, сколько лет он прожил на каждую букву из его имени и фамилии 
(чтобы было проще, учитывайте также пробелы). Например:

Enter your full name: Tom Cats
Enter your age: 45
You've lived 5.625 years for each letter in your name.

Уточнение: Возраст 45 делится на длину имени и фамилии «Tom Cats» (8 букв, учитывая пробел), что равно 5.625.

Мой ответ

#include <iostream>
#include <string>

int main()
{
	std::cout << "Введите свои имя и фамилию: ";
	std::string fullname;
	std::getline(std::cin, fullname);

	//std::cin.ignore(32767, '\n');

	std::cout << "Введите своЙ возраст: ";
	int age;
	std::cin >> age;

	float yearsOnLetter;

        yearsOnLetter=static_cast<float>(age)/fullname.length();
	std::cout << "На каждую букву вашего полного имени приходится " << yearsOnLetter << " лет." << std::endl;

}



Ответ

#include <iostream>
#include <string>
 
int main()
{
    std::cout << "Enter your full name: ";
    std::string myName;
    std::getline(std::cin, myName); // извлекаем целую строку из входного потока в переменную myName
 
    std::cout << "Enter your age: ";
    int myAge; // переменная myAge должна быть типа int, а не типа string, чтобы мы могли проводить с ней арифметические операции
    std::cin >> myAge;
 
    int letters = myName.length(); // вычисляем длину переменной myName (учитывая пробелы)
    double agePerLetter = static_cast<double>(myAge) / letters; // используем оператор static_cast, чтобы изменить тип переменной myAge на double, дабы сохранить дробную часть при целочисленном делении
    std::cout << "You've lived " << agePerLetter << " years for each letter in your name.\n";
 
    return 0;
}
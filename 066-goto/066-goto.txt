Урок No66. Оператор goto

Оператор goto — это оператор управления потоком выполнения программ, который заставляет центральный
процессор выполнить переход из одного участка кода в другой (осуществить прыжок). Другой участок кода
идентифицируется с помощью лейбла. Например:

1 #include <iostream>
2 #include <cmath> // для функции sqrt()
3
4 int main()
5 {
6  double z;
7  tryAgain: // это лейбл
8  std::cout << "Enter a non-negative number: ";
9  std::cin >> z;
10
11 if (z < 0.0)
12	 goto tryAgain; // а это оператор goto
13
14 std::cout << "The sqrt of " << z << " is " << sqrt(z) << std::endl;
15 return 0;
16 }

В этой программе пользователю предлагается ввести неотрицательное число. Однако, если пользователь введет
отрицательное число, программа, используя оператор goto, выполнит переход обратно к лейблу tryAgain. Затем
пользователю снова нужно будет ввести число. Таким образом, мы можем постоянно запрашивать у пользователя ввод
числа, пока он не введет корректное число.
Ранее мы рассматривали два типа области видимости: локальная (или «блочная») и глобальная (или «файловая»). Лейблы
используют третий тип области видимости: область видимости функции. Оператор goto и соответствующий лейбл
должны находиться в одной и той же функции.
Существуют некоторые ограничения на использование операторов goto. Например, вы не сможете перепрыгнуть вперед
через переменную, которая инициализирована в том же блоке, что и goto:

1 int main()
2 {
3 goto skip; // прыжок вперед недопустим
4 int z = 7;
5 skip: // лейбл
6 z += 4; // какое значение будет в этой переменной?
7 return 0;
8 }

В целом, программисты избегают использования оператора goto в языке C++ (и в большинстве других высокоуровневых
языков программирования). Основная проблема с ним заключается в том, что он позволяет программисту управлять
выполнением кода так, что точка выполнения может прыгать по коду произвольно. А это, в свою очередь, создает то, что
опытные программисты называют «спагетти-кодом». Спагетти-код — это код, порядок выполнения которого напоминает
тарелку со спагетти (всё запутано и закручено), что крайне затрудняет следование порядку и понимание логики
выполнения такого кода.
Как говорил один известный специалист в информатике и программировании, Эдсгер Дейкстра: «Качество программистов
— это уменьшающаяся функция плотности использования операторов goto в программах, которые они пишут».
Оператор goto часто используется в некоторых старых языках, таких как Basic или Fortran, или даже в языке Cи. Однако в
C++ goto почти никогда не используется, поскольку любой код, написанный с ним, можно более эффективно переписать с
использованием других объектов в языке C++, таких как циклы, обработчики исключений или деструкторы (всё
перечисленное мы рассмотрим чуть позже).

Правило: Избегайте использования операторов goto, если на это нет веских причин.